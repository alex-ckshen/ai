<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gemini Gloss Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <!-- Babel Standalone for in-browser JSX compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              mono: ['JetBrains Mono', 'monospace'],
            },
            colors: {
              glass: {
                light: 'rgba(255, 255, 255, 0.7)',
                dark: 'rgba(20, 20, 20, 0.7)',
                border: 'rgba(255, 255, 255, 0.2)',
                borderDark: 'rgba(255, 255, 255, 0.1)',
                surface: 'rgba(255, 255, 255, 0.4)',
                surfaceDark: 'rgba(30, 30, 30, 0.4)',
              }
            },
            animation: {
              'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
              'glow': 'glow 2s ease-in-out infinite alternate',
            },
            keyframes: {
              glow: {
                '0%': { boxShadow: '0 0 10px rgba(59, 130, 246, 0.5)' },
                '100%': { boxShadow: '0 0 25px rgba(59, 130, 246, 0.8), 0 0 10px rgba(59, 130, 246, 0.5)' }
              }
            }
          },
        },
      }
    </script>
    <style>
      body {
        transition: background-color 0.3s ease, color 0.3s ease;
      }
      /* Custom scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
      ::-webkit-scrollbar-track {
        background: transparent; 
      }
      ::-webkit-scrollbar-thumb {
        background: rgba(156, 163, 175, 0.5); 
        border-radius: 3px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: rgba(156, 163, 175, 0.8); 
      }
      
      .glass-panel {
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
      }
      
      .markdown-body p { margin-bottom: 0.75em; }
      .markdown-body pre { 
        background-color: rgba(0,0,0,0.1); 
        border-radius: 0.5rem; 
        padding: 1rem; 
        overflow-x: auto;
        font-family: 'JetBrains Mono', monospace;
        font-size: 0.875rem;
      }
      .dark .markdown-body pre { background-color: rgba(0,0,0,0.3); }
      .markdown-body code {
        font-family: 'JetBrains Mono', monospace;
        background-color: rgba(0,0,0,0.05);
        padding: 0.2em 0.4em;
        border-radius: 0.25rem;
        font-size: 0.875em;
      }
      .dark .markdown-body code { background-color: rgba(255,255,255,0.1); }
      
      /* Markdown List Styles */
      .markdown-body ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 0.75em; }
      .markdown-body ol { list-style-type: decimal; padding-left: 1.5em; margin-bottom: 0.75em; }
      .markdown-body li { margin-bottom: 0.25em; }

      /* Auto-scroll anchor */
      #anchor { overflow-anchor: auto; height: 1px; }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://aistudiocdn.com/react@^19.2.0",
        "react-dom/client": "https://aistudiocdn.com/react-dom@^19.2.0/client",
        "lucide-react": "https://aistudiocdn.com/lucide-react@^0.555.0",
        "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0",
        "react-markdown": "https://aistudiocdn.com/react-markdown@^10.1.0"
      }
    }
    </script>
  </head>
  <body class="bg-gray-100 text-gray-900 dark:bg-[#09090b] dark:text-gray-100 overflow-hidden">
    <div id="root"></div>

    <script type="text/babel" data-type="module" data-presets="typescript,react">
      import React, { useState, useEffect, useRef, useMemo } from 'react';
      import ReactDOM from 'react-dom/client';
      import { 
        Send, Bot, User, Loader2, Key, Moon, Sun, 
        Trash2, Terminal, Sparkles, AlertCircle, ChevronRight, Settings2,
        LayoutGrid, MessageSquare, Timer, Eye, EyeOff, Crown, Zap, Globe, Brain, Sliders
      } from 'lucide-react';
      import { GoogleGenAI } from "@google/genai";
      import ReactMarkdown from 'react-markdown';

      // --- Constants ---
      
      const DEFAULT_SYSTEM_PROMPT = "You are a helpful, precise, and creative AI assistant.";

      const MODEL_DATA = {
        "Gemini 2.0": [
          { id: "ui-gemini-2.0-flash", model: "gemini-2.0-flash", label: "Flash" },
          { id: "ui-gemini-2.0-flash-lite", model: "gemini-2.0-flash-lite-preview-02-05", label: "Flash Lite" },
          { id: "ui-gemini-2.0-flash-live", model: "gemini-2.0-flash-exp", label: "Flash Live" }, 
        ],
        "Gemini 2.5": [
          { id: "ui-gemini-2.5-flash", model: "gemini-2.5-flash", label: "Flash" }, 
          { id: "ui-gemini-2.5-flash-lite", model: "gemini-flash-lite-latest", label: "Flash Lite" },
          { id: "ui-gemini-2.5-pro", model: "gemini-3-pro-preview", label: "Pro" },
          { id: "ui-gemini-2.5-flash-live", model: "gemini-2.5-flash", label: "Flash Live" }, 
          { id: "ui-gemini-2.5-native-audio", model: "gemini-2.5-flash", label: "Native Audio" },
        ]
      };

      const COMPARE_MODELS = [
        { id: "cmp-2.0-flash", model: "gemini-2.0-flash", name: "2.0 Flash" },
        { id: "cmp-2.0-lite", model: "gemini-2.0-flash-lite-preview-02-05", name: "2.0 Lite" },
        { id: "cmp-2.0-live", model: "gemini-2.0-flash-exp", name: "2.0 Live" },
        { id: "cmp-2.5-flash", model: "gemini-2.5-flash", name: "2.5 Flash" },
        { id: "cmp-2.5-lite", model: "gemini-flash-lite-latest", name: "2.5 Lite" },
        { id: "cmp-2.5-live", model: "gemini-2.5-flash", name: "2.5 Live" }
      ];

      // --- Components ---

      // 1. API Key Modal
      const ApiKeyModal = ({ isOpen, onSubmit, initialKey }) => {
        const [key, setKey] = useState(initialKey || '');
        const inputRef = useRef(null);
        useEffect(() => {
          if (isOpen && inputRef.current) inputRef.current.focus();
        }, [isOpen]);

        if (!isOpen) return null;

        return (
          <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm transition-opacity">
            <div className="bg-white dark:bg-[#18181b] p-8 rounded-2xl shadow-2xl max-w-md w-full border border-gray-200 dark:border-gray-800 animate-glow">
              <div className="flex flex-col items-center gap-4 text-center">
                <div className="p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full text-blue-600 dark:text-blue-400">
                  <Key size={32} />
                </div>
                <h2 className="text-2xl font-bold">Enter API Key</h2>
                <p className="text-sm text-gray-500 dark:text-gray-400">
                  To start chatting, please provide your Google GenAI API Key.
                </p>
                <input
                  ref={inputRef}
                  type="password"
                  value={key}
                  onChange={(e) => setKey(e.target.value)}
                  placeholder="AIzaSy..."
                  className="w-full px-4 py-3 bg-gray-50 dark:bg-[#27272a] border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm transition-all"
                  onKeyDown={(e) => e.key === 'Enter' && key && onSubmit(key)}
                />
                <button
                  onClick={() => onSubmit(key)}
                  disabled={!key}
                  className="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-blue-500/20"
                >
                  Start Experience
                </button>
              </div>
            </div>
          </div>
        );
      };

      // 2. Model Selector (Chat Mode)
      const ModelSelector = ({ selectedModel, setSelectedModel, selectedFamily, setSelectedFamily }) => {
        return (
          <div className="flex flex-col gap-4">
            <label className="text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400 flex items-center gap-2">
              <Settings2 size={12} />
              Model Configuration
            </label>
            
            <div className="p-3 bg-white/50 dark:bg-black/20 rounded-xl border border-gray-200/50 dark:border-white/5 shadow-sm space-y-4">
              
              {/* Family Group: Gemini 2.0 */}
              <div className="space-y-2">
                <div className="text-[10px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider pl-1">
                  Gemini 2.0
                </div>
                <div className="flex flex-wrap gap-2">
                  {MODEL_DATA["Gemini 2.0"].map((model) => (
                    <button
                      key={model.id}
                      onClick={() => {
                        setSelectedFamily("Gemini 2.0");
                        setSelectedModel(model.id);
                      }}
                      className={`px-2.5 py-1.5 text-xs font-medium rounded-lg border transition-all truncate flex-1 min-w-[70px] ${
                        selectedModel === model.id
                          ? 'bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-700 dark:text-blue-300 shadow-sm'
                          : 'bg-white dark:bg-white/5 border-transparent hover:border-gray-300 dark:hover:border-gray-600 text-gray-700 dark:text-gray-300'
                      }`}
                    >
                      {model.label}
                    </button>
                  ))}
                </div>
              </div>

              {/* Family Group: Gemini 2.5 */}
              <div className="space-y-2">
                <div className="text-[10px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider pl-1">
                  Gemini 2.5
                </div>
                <div className="grid grid-cols-2 gap-2">
                  {MODEL_DATA["Gemini 2.5"].map((model) => (
                    <button
                      key={model.id}
                      onClick={() => {
                        setSelectedFamily("Gemini 2.5");
                        setSelectedModel(model.id);
                      }}
                      className={`px-2.5 py-1.5 text-xs font-medium rounded-lg border transition-all truncate text-left ${
                        selectedModel === model.id
                          ? 'bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-700 dark:text-blue-300 shadow-sm'
                          : 'bg-white dark:bg-white/5 border-transparent hover:border-gray-300 dark:hover:border-gray-600 text-gray-700 dark:text-gray-300'
                      }`}
                    >
                      {model.label}
                    </button>
                  ))}
                </div>
              </div>

            </div>
          </div>
        );
      };

      // 3. Advanced Tools Component
      const AdvancedTools = ({ 
        enableSearch, 
        setEnableSearch, 
        thinkingMode, 
        setThinkingMode, 
        thinkingBudget, 
        setThinkingBudget,
        selectedFamily 
      }) => {
        const isThinkingSupported = selectedFamily === "Gemini 2.5";

        return (
          <div className="flex flex-col gap-4">
             <label className="text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400 flex items-center gap-2">
                <Zap size={12} />
                Tools & Settings
             </label>
             <div className="p-3 bg-white/50 dark:bg-black/20 rounded-xl border border-gray-200/50 dark:border-white/5 shadow-sm space-y-4">
                
                {/* Google Search Toggle */}
                <div className="flex items-center justify-between">
                   <div className="flex items-center gap-2">
                      <div className={`p-1.5 rounded-md ${enableSearch ? 'bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400' : 'bg-gray-100 text-gray-500 dark:bg-white/10 dark:text-gray-400'}`}>
                        <Globe size={14} />
                      </div>
                      <div className="flex flex-col">
                        <span className="text-xs font-medium text-gray-700 dark:text-gray-200">Google Search</span>
                        <span className="text-[10px] text-gray-500">Grounding</span>
                      </div>
                   </div>
                   <button 
                      onClick={() => setEnableSearch(!enableSearch)}
                      className={`w-8 h-4 rounded-full transition-colors relative ${enableSearch ? 'bg-blue-600' : 'bg-gray-300 dark:bg-gray-600'}`}
                   >
                      <div className={`absolute top-0.5 w-3 h-3 rounded-full bg-white transition-transform shadow-sm ${enableSearch ? 'left-[18px]' : 'left-0.5'}`} />
                   </button>
                </div>

                {/* Thinking Config */}
                {isThinkingSupported && (
                  <div className="space-y-3 pt-2 border-t border-gray-100 dark:border-white/5">
                    <div className="flex items-center justify-between">
                       <div className="flex items-center gap-2">
                          <div className={`p-1.5 rounded-md ${thinkingMode !== 'off' ? 'bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400' : 'bg-gray-100 text-gray-500 dark:bg-white/10 dark:text-gray-400'}`}>
                            <Brain size={14} />
                          </div>
                          <div className="flex flex-col">
                            <span className="text-xs font-medium text-gray-700 dark:text-gray-200">Thinking</span>
                            <span className="text-[10px] text-gray-500">Reasoning Budget</span>
                          </div>
                       </div>
                       <select 
                          value={thinkingMode}
                          onChange={(e) => setThinkingMode(e.target.value)}
                          className="bg-transparent text-xs border border-gray-200 dark:border-gray-700 rounded px-1 py-0.5 text-gray-700 dark:text-gray-300 focus:outline-none"
                       >
                          <option value="auto">Auto</option>
                          <option value="custom">Custom</option>
                          <option value="off">Off</option>
                       </select>
                    </div>

                    {thinkingMode === 'custom' && (
                       <div className="space-y-1">
                          <div className="flex justify-between text-[10px] text-gray-500">
                             <span>1024</span>
                             <span className="font-mono text-purple-600 dark:text-purple-400">{thinkingBudget}</span>
                             <span>32k</span>
                          </div>
                          <input 
                             type="range" 
                             min="1024" 
                             max="32768" 
                             step="1024"
                             value={thinkingBudget}
                             onChange={(e) => setThinkingBudget(Number(e.target.value))}
                             className="w-full h-1 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-purple-600"
                          />
                       </div>
                    )}
                  </div>
                )}
             </div>
          </div>
        )
      }

      // 4. Compare Toggles (Compare Mode)
      const CompareToggles = ({ 
        activeModels, 
        toggleModel, 
        enableSearch, 
        setEnableSearch, 
        thinkingConfigs, 
        setThinkingConfigs 
      }) => {

        const updateThinking = (id, field, value) => {
           setThinkingConfigs(prev => ({
              ...prev,
              [id]: { ...prev[id] || { mode: 'off', budget: 1024 }, [field]: value }
           }));
        };

        return (
           <div className="flex flex-col gap-4">
            <label className="text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400 flex items-center gap-2">
              <Zap size={12} />
              Compare Tools
            </label>
            <div className="p-3 bg-white/50 dark:bg-black/20 rounded-xl border border-gray-200/50 dark:border-white/5 shadow-sm space-y-3">
               {/* Global Search Toggle */}
               <div className="flex items-center justify-between">
                   <div className="flex items-center gap-2">
                      <div className={`p-1.5 rounded-md ${enableSearch ? 'bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400' : 'bg-gray-100 text-gray-500 dark:bg-white/10 dark:text-gray-400'}`}>
                        <Globe size={14} />
                      </div>
                      <div className="flex flex-col">
                        <span className="text-xs font-medium text-gray-700 dark:text-gray-200">All: Search</span>
                      </div>
                   </div>
                   <button 
                      onClick={() => setEnableSearch(!enableSearch)}
                      className={`w-8 h-4 rounded-full transition-colors relative ${enableSearch ? 'bg-blue-600' : 'bg-gray-300 dark:bg-gray-600'}`}
                   >
                      <div className={`absolute top-0.5 w-3 h-3 rounded-full bg-white transition-transform shadow-sm ${enableSearch ? 'left-[18px]' : 'left-0.5'}`} />
                   </button>
                </div>
            </div>

            <label className="text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400 flex items-center gap-2 mt-2">
              <Eye size={12} />
              Active Models
            </label>
            <div className="space-y-2">
                {COMPARE_MODELS.map(model => {
                  const isActive = activeModels.includes(model.id);
                  const isThinkingSupported = model.id.includes("2.5");
                  const tConfig = thinkingConfigs[model.id] || { mode: 'off', budget: 1024 };

                  return (
                    <div 
                      key={model.id}
                      className={`rounded-lg border transition-all overflow-hidden ${
                        isActive 
                        ? 'bg-white dark:bg-black/20 border-blue-200 dark:border-blue-900/50' 
                        : 'bg-white/50 dark:bg-white/5 border-transparent opacity-70'
                      }`}
                    >
                      {/* Header Row */}
                      <div className="flex items-center justify-between p-2.5">
                         <span className={`text-xs font-medium ${isActive ? 'text-blue-700 dark:text-blue-300' : 'text-gray-500'}`}>
                           {model.name}
                         </span>
                         <button onClick={() => toggleModel(model.id)}>
                            {isActive ? <Eye size={14} className="text-blue-600 dark:text-blue-400" /> : <EyeOff size={14} className="text-gray-400" />}
                         </button>
                      </div>

                      {/* Config Row (Thinking) */}
                      {isActive && isThinkingSupported && (
                        <div className="px-2.5 pb-2.5 pt-1 border-t border-gray-100 dark:border-white/5 bg-gray-50/50 dark:bg-white/[0.02]">
                           <div className="flex items-center justify-between mb-1.5">
                              <div className="flex items-center gap-1.5 text-[10px] text-gray-500">
                                 <Brain size={10} />
                                 <span>Thinking</span>
                              </div>
                              <select 
                                value={tConfig.mode}
                                onChange={(e) => updateThinking(model.id, 'mode', e.target.value)}
                                className="bg-transparent text-[10px] border border-gray-200 dark:border-gray-700 rounded px-1 py-0.5 text-gray-700 dark:text-gray-300 focus:outline-none"
                             >
                                <option value="off">Off</option>
                                <option value="auto">Auto</option>
                                <option value="custom">Set</option>
                             </select>
                           </div>
                           
                           {tConfig.mode === 'custom' && (
                              <div className="flex items-center gap-2">
                                <input 
                                   type="range" 
                                   min="1024" 
                                   max="32768" 
                                   step="1024"
                                   value={tConfig.budget}
                                   onChange={(e) => updateThinking(model.id, 'budget', Number(e.target.value))}
                                   className="flex-1 h-1 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-purple-600"
                                />
                                <span className="text-[9px] font-mono text-gray-500 w-8 text-right">{Math.round(tConfig.budget/1024)}k</span>
                              </div>
                           )}
                        </div>
                      )}
                    </div>
                  )
                })}
            </div>
           </div>
        )
      }

      // 5. Chat Interface Component
      const ChatInterface = ({ 
        messages, 
        input, 
        setInput, 
        isLoading, 
        handleSend, 
        selectedFamily, 
        selectedModel,
        currentModelLabel,
        messagesEndRef,
        chatContainerRef
      }) => {
        return (
          <main className="flex-1 flex flex-col min-w-0 relative bg-white/50 dark:bg-[#09090b] glass-panel transition-colors duration-500 h-full">
            {/* Header */}
            <header className="absolute top-0 left-0 right-0 z-10 p-6 flex items-center justify-between pointer-events-none">
              <div className="pointer-events-auto">
                <h1 className="text-3xl font-bold tracking-tighter bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-400 dark:to-purple-400 drop-shadow-sm">
                  {selectedFamily}
                </h1>
                <div className="flex items-center gap-2 mt-1">
                  <span className="text-xs font-mono uppercase tracking-widest text-gray-500 dark:text-gray-500">
                    RUNNING
                  </span>
                  <span className="text-xs font-bold px-2 py-0.5 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-800">
                    {currentModelLabel}
                  </span>
                </div>
              </div>
            </header>

            {/* Messages */}
            <div 
              ref={chatContainerRef}
              className="flex-1 overflow-y-auto px-4 md:px-20 pt-32 pb-4 scroll-smooth"
            >
              {messages.length === 0 ? (
                <div className="h-full flex flex-col items-center justify-center opacity-40 select-none">
                  <div className="w-24 h-24 rounded-full bg-gradient-to-tr from-blue-500 to-purple-500 opacity-20 blur-xl absolute"></div>
                  <Sparkles size={48} className="text-gray-400 dark:text-gray-600 mb-4 relative z-10" />
                  <p className="text-xl font-medium text-gray-400 dark:text-gray-600">Start a conversation</p>
                </div>
              ) : (
                <div className="space-y-6 max-w-4xl mx-auto">
                  {messages.map((msg, idx) => (
                    <div 
                      key={idx} 
                      className={`group flex gap-4 ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}
                    >
                       {msg.role === 'model' && (
                         <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shrink-0 shadow-lg shadow-blue-500/20 mt-1">
                           <Bot size={16} className="text-white" />
                         </div>
                       )}
                       
                       <div className="flex flex-col gap-1 max-w-[85%]">
                         <div className={`relative rounded-2xl px-6 py-4 shadow-sm text-sm leading-relaxed ${
                           msg.role === 'user' 
                             ? 'bg-blue-600 text-white rounded-br-sm' 
                             : 'bg-white dark:bg-[#18181b] border border-gray-100 dark:border-gray-800 text-gray-800 dark:text-gray-200 rounded-bl-sm'
                         }`}>
                           {msg.role === 'model' ? (
                             <div className="markdown-body">
                               <ReactMarkdown>{msg.text}</ReactMarkdown>
                             </div>
                           ) : (
                             <div className="whitespace-pre-wrap">{msg.text}</div>
                           )}

                           {/* Grounding Sources */}
                           {msg.groundingMetadata && msg.groundingMetadata.groundingChunks && msg.groundingMetadata.groundingChunks.length > 0 && (
                             <div className="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700/50">
                               <div className="text-[10px] font-semibold text-gray-500 uppercase tracking-wider mb-2 flex items-center gap-1">
                                 <Globe size={10} /> Sources
                               </div>
                               <div className="flex flex-wrap gap-2">
                                 {msg.groundingMetadata.groundingChunks.map((chunk, i) => (
                                    chunk.web && (
                                      <a 
                                        key={i} 
                                        href={chunk.web.uri} 
                                        target="_blank" 
                                        rel="noopener noreferrer"
                                        className="flex items-center gap-1.5 px-2 py-1 bg-gray-100 dark:bg-white/5 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md text-xs text-blue-600 dark:text-blue-400 transition-colors border border-transparent hover:border-blue-100 dark:hover:border-blue-900/30"
                                      >
                                        <span className="truncate max-w-[150px]">{chunk.web.title || "Source"}</span>
                                        <ChevronRight size={10} className="opacity-50" />
                                      </a>
                                    )
                                 ))}
                               </div>
                             </div>
                           )}
                         </div>
                         {msg.metrics && (
                           <div className="flex items-center gap-1 text-[10px] text-gray-400 px-1 self-end">
                              <Timer size={10} />
                              {msg.metrics.duration}ms
                           </div>
                         )}
                       </div>

                       {msg.role === 'user' && (
                         <div className="w-8 h-8 rounded-lg bg-gray-200 dark:bg-gray-800 flex items-center justify-center shrink-0 mt-1">
                           <User size={16} className="text-gray-500 dark:text-gray-400" />
                         </div>
                       )}
                    </div>
                  ))}
                  {isLoading && (
                     <div className="flex gap-4 max-w-4xl">
                       <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shrink-0 opacity-50">
                         <Bot size={16} className="text-white" />
                       </div>
                       <div className="flex items-center gap-2 text-gray-400 text-sm animate-pulse px-4 py-2">
                         <Loader2 size={16} className="animate-spin" />
                         Thinking...
                       </div>
                     </div>
                  )}
                  <div ref={messagesEndRef} className="h-px w-full" />
                </div>
              )}
            </div>

            {/* Input */}
            <div className="p-6 bg-gradient-to-t from-white via-white/80 to-transparent dark:from-[#09090b] dark:via-[#09090b]/80 dark:to-transparent z-20">
              <div className="max-w-4xl mx-auto relative group">
                <div className="absolute -inset-0.5 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl opacity-20 group-focus-within:opacity-50 transition duration-500 blur"></div>
                <div className="relative flex items-end gap-2 bg-white dark:bg-[#18181b] rounded-xl p-2 border border-gray-200 dark:border-gray-800 shadow-xl">
                  <textarea
                    value={input}
                    onChange={(e) => setInput(e.target.value)}
                    onKeyDown={(e) => {
                      if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        handleSend();
                      }
                    }}
                    placeholder={`Message ${selectedFamily} ${currentModelLabel}...`}
                    className="w-full bg-transparent border-none focus:ring-0 resize-none max-h-40 min-h-[50px] py-3 px-4 text-gray-800 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500"
                    rows={1}
                    style={{ height: 'auto', minHeight: '52px' }} 
                  />
                  <button
                    onClick={handleSend}
                    disabled={!input.trim() || isLoading}
                    className="mb-1 p-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50 disabled:bg-gray-400 transition-all shadow-lg shadow-blue-600/20"
                  >
                    {isLoading ? <Loader2 size={18} className="animate-spin" /> : <Send size={18} />}
                  </button>
                </div>
              </div>
            </div>
          </main>
        );
      }

      // 6. Compare Interface Component
      const CompareInterface = ({ 
        compareResults,
        isComparing,
        compareInput,
        setCompareInput,
        handleCompare,
        activeModels
      }) => {

        // Calculate winner based on highest speed (chars/sec)
        // Only consider models that are not loading and have no error
        const winnerId = useMemo(() => {
          if (isComparing) return null;
          let maxSpeed = -1;
          let wId = null;
          
          Object.entries(compareResults).forEach(([id, result]) => {
            if (!result.loading && !result.error && result.speed > maxSpeed) {
              maxSpeed = result.speed;
              wId = id;
            }
          });
          return wId;
        }, [compareResults, isComparing]);

        const activeModelsList = COMPARE_MODELS.filter(m => activeModels.includes(m.id));

        return (
          <main className="flex-1 flex flex-col min-w-0 relative bg-gray-50 dark:bg-[#0c0c0e] h-full overflow-hidden">
            <header className="px-6 py-4 border-b border-gray-200 dark:border-gray-800 bg-white dark:bg-[#09090b] flex items-center gap-2">
              <LayoutGrid size={20} className="text-blue-600 dark:text-blue-400" />
              <h1 className="text-lg font-bold">Compare Models</h1>
              <span className="text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-800 rounded-full text-gray-500 ml-2">
                {activeModels.length} Active
              </span>
            </header>

            {/* Grid Container */}
            <div className="flex-1 w-full overflow-hidden flex flex-col">
              <div className="flex-1 flex w-full h-full divide-x divide-gray-200 dark:divide-gray-800 overflow-x-hidden">
                {activeModelsList.length === 0 ? (
                  <div className="w-full flex flex-col items-center justify-center text-gray-400">
                    <EyeOff size={48} className="mb-4 opacity-20" />
                    <p>No models selected. Use the sidebar to enable models.</p>
                  </div>
                ) : (
                  activeModelsList.map((model) => {
                    const result = compareResults[model.id];
                    const isWinner = winnerId === model.id;

                    return (
                      <div key={model.id} className="flex-1 min-w-0 flex flex-col h-full bg-white/50 dark:bg-[#09090b]/50">
                        {/* Column Header */}
                        <div className={`p-3 border-b border-gray-200 dark:border-gray-800 flex justify-between items-center sticky top-0 ${isWinner ? 'bg-yellow-50/50 dark:bg-yellow-900/10' : 'bg-gray-50/50 dark:bg-[#121214]'}`}>
                          <div className="flex items-center gap-1.5 overflow-hidden">
                            {isWinner && <Crown size={14} className="text-yellow-500 fill-yellow-500 shrink-0" />}
                            <span className={`font-mono text-xs font-bold truncate ${isWinner ? 'text-yellow-700 dark:text-yellow-500' : 'text-gray-700 dark:text-gray-200'}`}>
                              {model.name}
                            </span>
                          </div>
                          {result?.speed && (
                            <span className={`text-[10px] px-1.5 py-0.5 rounded flex items-center gap-1 shrink-0 ${
                              isWinner 
                                ? 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 font-bold' 
                                : 'bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400'
                            }`}>
                              <Zap size={8} /> {result.speed}/s
                            </span>
                          )}
                        </div>
                        
                        {/* Content Area */}
                        <div className="flex-1 overflow-y-auto p-4 text-xs leading-relaxed text-gray-800 dark:text-gray-200 scrollbar-thin">
                          {!result && !isComparing && (
                            <div className="h-full flex items-center justify-center opacity-10">
                              <Bot size={24} />
                            </div>
                          )}
                          {result?.loading && (
                            <div className="flex items-center gap-2 text-gray-400 animate-pulse">
                              <Loader2 size={14} className="animate-spin" />
                              <span>Generating...</span>
                            </div>
                          )}
                          {result?.error && (
                            <div className="text-red-500 p-2 bg-red-50 dark:bg-red-900/10 rounded break-words">
                              {result.error}
                            </div>
                          )}
                          {result?.text && (
                            <div className="markdown-body text-xs break-words">
                               <ReactMarkdown>{result.text}</ReactMarkdown>
                               {/* Grounding in Compare */}
                               {result.groundingMetadata?.groundingChunks?.length > 0 && (
                                 <div className="mt-4 pt-3 border-t border-gray-200 dark:border-gray-700/50">
                                   <div className="text-[9px] font-semibold text-gray-500 uppercase tracking-wider mb-2 flex items-center gap-1">
                                     <Globe size={10} /> Sources
                                   </div>
                                   <div className="flex flex-col gap-1">
                                     {result.groundingMetadata.groundingChunks.map((chunk, i) => (
                                        chunk.web && (
                                          <a 
                                            key={i} 
                                            href={chunk.web.uri} 
                                            target="_blank" 
                                            rel="noopener noreferrer"
                                            className="flex items-center gap-1.5 px-2 py-1 bg-gray-100 dark:bg-white/5 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md text-[10px] text-blue-600 dark:text-blue-400 transition-colors"
                                          >
                                            <span className="truncate">{chunk.web.title || "Source"}</span>
                                            <ChevronRight size={10} className="opacity-50 ml-auto" />
                                          </a>
                                        )
                                     ))}
                                   </div>
                                 </div>
                               )}
                            </div>
                          )}
                        </div>
                      </div>
                    )
                  })
                )}
              </div>
            </div>

            {/* Input */}
            <div className="p-4 border-t border-gray-200 dark:border-gray-800 bg-white dark:bg-[#09090b]">
              <div className="max-w-5xl mx-auto flex gap-2">
                <input
                   type="text"
                   value={compareInput}
                   onChange={(e) => setCompareInput(e.target.value)}
                   onKeyDown={(e) => e.key === 'Enter' && handleCompare()}
                   disabled={activeModelsList.length === 0}
                   placeholder={activeModelsList.length === 0 ? "Select at least one model..." : "Enter a prompt to compare..."}
                   className="flex-1 bg-gray-100 dark:bg-[#18181b] border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white text-sm disabled:opacity-50 disabled:cursor-not-allowed"
                />
                <button
                  onClick={handleCompare}
                  disabled={!compareInput.trim() || isComparing || activeModelsList.length === 0}
                  className="px-6 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg shadow-blue-600/20"
                >
                  {isComparing ? <Loader2 size={16} className="animate-spin" /> : <Send size={16} />}
                  Run
                </button>
              </div>
            </div>
          </main>
        );
      }

      // 7. Main App Component
      const App = () => {
        // --- State ---
        const [theme, setTheme] = useState(() => localStorage.getItem('theme') || 'dark');
        const [apiKey, setApiKey] = useState(() => localStorage.getItem('gemini_api_key') || '');
        const [isKeyModalOpen, setIsKeyModalOpen] = useState(false);
        const [viewMode, setViewMode] = useState('chat'); // 'chat' | 'compare'
        
        // Chat State
        const [messages, setMessages] = useState([]);
        const [input, setInput] = useState('');
        const [isLoading, setIsLoading] = useState(false);
        const [systemPrompt, setSystemPrompt] = useState(DEFAULT_SYSTEM_PROMPT);
        
        // Advanced Tools State
        const [enableSearch, setEnableSearch] = useState(false);
        const [thinkingMode, setThinkingMode] = useState('auto'); // 'auto', 'custom', 'off'
        const [thinkingBudget, setThinkingBudget] = useState(1024);

        // Compare State
        const [compareInput, setCompareInput] = useState('');
        const [isComparing, setIsComparing] = useState(false);
        const [compareResults, setCompareResults] = useState({});
        const [activeCompareModels, setActiveCompareModels] = useState(COMPARE_MODELS.map(m => m.id));
        const [enableCompareSearch, setEnableCompareSearch] = useState(false);
        const [compareThinkingConfigs, setCompareThinkingConfigs] = useState({});

        // Model Selection State (Chat Mode)
        const [selectedFamily, setSelectedFamily] = useState("Gemini 2.5");
        const [selectedModel, setSelectedModel] = useState("ui-gemini-2.5-flash");

        // Refs
        const messagesEndRef = useRef(null);
        const chatContainerRef = useRef(null);

        // --- Effects ---
        useEffect(() => {
          if (theme === 'dark') document.documentElement.classList.add('dark');
          else document.documentElement.classList.remove('dark');
          localStorage.setItem('theme', theme);
        }, [theme]);

        useEffect(() => {
          if (!apiKey) setIsKeyModalOpen(true);
        }, []);

        useEffect(() => {
          if (viewMode === 'chat') {
             messagesEndRef.current?.scrollIntoView({ behavior: 'smooth', block: 'end' });
          }
        }, [messages, isLoading, viewMode]);

        // --- Handlers ---

        const handleApiKeySubmit = (key) => {
          setApiKey(key);
          localStorage.setItem('gemini_api_key', key);
          setIsKeyModalOpen(false);
        };

        const handleClearChat = () => {
          setMessages([]);
          setInput('');
          setCompareResults({});
        };

        const toggleCompareModel = (modelId) => {
          setActiveCompareModels(prev => 
            prev.includes(modelId) 
              ? prev.filter(id => id !== modelId)
              : [...prev, modelId]
          );
        };

        // Chat Send Handler
        const handleSend = async () => {
          if (!input.trim() || isLoading) return;
          const currentInput = input.trim();
          setInput('');
          
          const startTime = performance.now();
          const userMsg = { role: 'user', text: currentInput, timestamp: Date.now() };
          setMessages(prev => [...prev, userMsg]);
          setIsLoading(true);

          try {
            const ai = new GoogleGenAI({ apiKey });
            const history = messages.map(m => ({
              role: m.role,
              parts: [{ text: m.text }]
            }));

            const modelConfig = MODEL_DATA[selectedFamily].find(m => m.id === selectedModel);
            const apiModelName = modelConfig ? modelConfig.model : "gemini-2.5-flash";

            // Construct Configuration
            const requestConfig = {
              systemInstruction: systemPrompt,
              temperature: 0.7,
            };

            // Add Search Tool
            if (enableSearch) {
              requestConfig.tools = [{ googleSearch: {} }];
            }

            // Add Thinking Config (Only for Gemini 2.5)
            if (selectedFamily === "Gemini 2.5") {
               if (thinkingMode === 'custom') {
                 requestConfig.thinkingConfig = { thinkingBudget: thinkingBudget };
               } else if (thinkingMode === 'off') {
                 requestConfig.thinkingConfig = { thinkingBudget: 0 };
               }
               // 'auto' does not send thinkingConfig
            }

            const chatSession = ai.chats.create({
              model: apiModelName,
              config: requestConfig,
              history: history,
            });

            setMessages(prev => [...prev, { role: 'model', text: '', timestamp: Date.now() }]);

            const result = await chatSession.sendMessageStream({ message: currentInput });
            
            let fullText = "";
            let finalGroundingMetadata = null;

            for await (const chunk of result) {
              const text = chunk.text;
              if (text) fullText += text;
              
              // Capture grounding metadata if available in chunk
              if (chunk.candidates?.[0]?.groundingMetadata) {
                finalGroundingMetadata = chunk.candidates[0].groundingMetadata;
              }

              setMessages(prev => {
                const newMsgs = [...prev];
                const lastMsg = newMsgs[newMsgs.length - 1];
                if (lastMsg.role === 'model') {
                  lastMsg.text = fullText;
                  if (finalGroundingMetadata) {
                    lastMsg.groundingMetadata = finalGroundingMetadata;
                  }
                }
                return newMsgs;
              });
            }
            
            // Calculate final duration
            const endTime = performance.now();
            const duration = (endTime - startTime).toFixed(0);
            
            setMessages(prev => {
               const newMsgs = [...prev];
               const lastMsg = newMsgs[newMsgs.length - 1];
               if (lastMsg.role === 'model') {
                 lastMsg.metrics = { duration };
               }
               return newMsgs;
            });

          } catch (error) {
            console.error("GenAI Error:", error);
            const modelConfig = MODEL_DATA[selectedFamily].find(m => m.id === selectedModel);
            const apiModelName = modelConfig ? modelConfig.model : selectedModel;
            let errorMessage = error.message;
            if (errorMessage.includes("404")) {
               errorMessage = `The model "${apiModelName}" was not found (404).`;
            }
            setMessages(prev => [...prev, { role: 'model', text: `**Error**: ${errorMessage}`, timestamp: Date.now() }]);
          } finally {
            setIsLoading(false);
          }
        };

        // Compare Handler
        const handleCompare = async () => {
          if (!compareInput.trim() || isComparing) return;
          const prompt = compareInput.trim();
          setIsComparing(true);
          
          // Get only active models
          const targetModels = COMPARE_MODELS.filter(m => activeCompareModels.includes(m.id));

          // Initialize results state for active models only
          const initialResults = {};
          targetModels.forEach(m => {
            initialResults[m.id] = { 
              text: '', 
              loading: true, 
              error: null, 
              speed: null, 
              startTime: performance.now(),
              groundingMetadata: null
            };
          });
          
          setCompareResults(initialResults);

          const ai = new GoogleGenAI({ apiKey });

          // Launch requests in parallel
          const promises = targetModels.map(async (model) => {
             try {
               const chatConfig = { systemInstruction: systemPrompt };
               
               // Apply Global Search
               if (enableCompareSearch) {
                 chatConfig.tools = [{ googleSearch: {} }];
               }

               // Apply Per-Model Thinking Config (if active and supported)
               // Only 2.5 supports thinking.
               if (model.id.includes("2.5")) {
                 const tConfig = compareThinkingConfigs[model.id] || { mode: 'off', budget: 1024 };
                 if (tConfig.mode === 'off') {
                   chatConfig.thinkingConfig = { thinkingBudget: 0 };
                 } else if (tConfig.mode === 'custom') {
                   chatConfig.thinkingConfig = { thinkingBudget: tConfig.budget };
                 }
                 // If auto, do not send thinkingConfig
               }

               const chat = ai.chats.create({
                 model: model.model,
                 config: chatConfig
               });
               
               const resultStream = await chat.sendMessageStream({ message: prompt });
               let fullText = "";
               let groundingMetadata = null;
               
               for await (const chunk of resultStream) {
                 const text = chunk.text;
                 if (text) {
                   fullText += text;
                 }
                 if (chunk.candidates?.[0]?.groundingMetadata) {
                   groundingMetadata = chunk.candidates[0].groundingMetadata;
                 }
                 
                 setCompareResults(prev => ({
                   ...prev,
                   [model.id]: { 
                      ...prev[model.id], 
                      text: fullText,
                      groundingMetadata: groundingMetadata || prev[model.id]?.groundingMetadata
                   }
                 }));
               }
               
               const endTime = performance.now();
               const durationMs = endTime - initialResults[model.id].startTime;
               const durationSec = durationMs / 1000;
               // Avoid division by zero
               const speed = durationSec > 0 ? (fullText.length / durationSec).toFixed(1) : "0";

               setCompareResults(prev => ({
                 ...prev,
                 [model.id]: { 
                   ...prev[model.id], 
                   text: fullText, 
                   loading: false, 
                   speed: speed,
                   groundingMetadata: groundingMetadata 
                 }
               }));

             } catch (err) {
               console.error(err);
               setCompareResults(prev => ({
                 ...prev,
                 [model.id]: { ...prev[model.id], loading: false, error: err.message, speed: 0 }
               }));
             }
          });

          await Promise.allSettled(promises);
          setIsComparing(false);
        };

        const currentModelLabel = MODEL_DATA[selectedFamily].find(m => m.id === selectedModel)?.label || selectedModel;

        return (
          <div className="flex h-screen w-full font-sans antialiased text-gray-900 dark:text-gray-100 bg-gray-50 dark:bg-[#09090b] transition-colors duration-500">
            
            <ApiKeyModal isOpen={isKeyModalOpen} onSubmit={handleApiKeySubmit} initialKey={apiKey} />

            {/* Content Area Switcher */}
            {viewMode === 'chat' ? (
              <ChatInterface 
                messages={messages}
                input={input}
                setInput={setInput}
                isLoading={isLoading}
                handleSend={handleSend}
                selectedFamily={selectedFamily}
                selectedModel={selectedModel}
                currentModelLabel={currentModelLabel}
                messagesEndRef={messagesEndRef}
                chatContainerRef={chatContainerRef}
              />
            ) : (
              <CompareInterface 
                compareResults={compareResults}
                isComparing={isComparing}
                compareInput={compareInput}
                setCompareInput={setCompareInput}
                handleCompare={handleCompare}
                activeModels={activeCompareModels}
              />
            )}

            {/* Right Sidebar */}
            <aside className="w-80 shrink-0 bg-gray-50/80 dark:bg-[#0c0c0e]/90 border-l border-gray-200 dark:border-white/5 flex flex-col backdrop-blur-xl z-20 relative shadow-2xl">
              
              <div className="p-4 border-b border-gray-200 dark:border-white/5 space-y-4">
                <button
                  onClick={handleClearChat}
                  className="w-full flex items-center justify-center gap-2 py-3 px-4 bg-white dark:bg-white/5 hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-700 dark:text-gray-200 hover:text-red-600 dark:hover:text-red-400 rounded-xl border border-gray-200 dark:border-white/10 transition-all font-medium text-sm group shadow-sm"
                >
                  <Trash2 size={16} className="group-hover:scale-110 transition-transform" />
                  {viewMode === 'chat' ? 'New Chat' : 'Clear Comparison'}
                </button>
                
                 {/* API Key Btn */}
                 <button 
                    onClick={() => setIsKeyModalOpen(true)}
                    className="w-full text-xs font-medium text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 flex items-center justify-center gap-1 bg-transparent px-3 py-2 rounded-lg border border-dashed border-gray-300 dark:border-gray-700 transition-all"
                  >
                    <Key size={12} />
                    Change API Key
                  </button>
              </div>

              <div className="flex-1 overflow-y-auto p-4 space-y-6">
                <div className="space-y-3">
                  <label className="text-xs font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400 flex items-center gap-2">
                    <Terminal size={12} />
                    System Prompt
                  </label>
                  <textarea
                     value={systemPrompt}
                     onChange={(e) => setSystemPrompt(e.target.value)}
                     className="w-full h-32 bg-white dark:bg-black/20 border border-gray-200 dark:border-white/10 rounded-xl p-3 text-xs font-mono text-gray-600 dark:text-gray-300 focus:outline-none resize-none"
                     placeholder="Define the AI persona..."
                  />
                </div>
                
                {/* Advanced Tools (Chat Mode) */}
                {viewMode === 'chat' && (
                  <AdvancedTools 
                    enableSearch={enableSearch}
                    setEnableSearch={setEnableSearch}
                    thinkingMode={thinkingMode}
                    setThinkingMode={setThinkingMode}
                    thinkingBudget={thinkingBudget}
                    setThinkingBudget={setThinkingBudget}
                    selectedFamily={selectedFamily}
                  />
                )}

                {/* Compare Mode Toggles */}
                {viewMode === 'compare' && (
                  <CompareToggles 
                    activeModels={activeCompareModels}
                    toggleModel={toggleCompareModel}
                    enableSearch={enableCompareSearch}
                    setEnableSearch={setEnableCompareSearch}
                    thinkingConfigs={compareThinkingConfigs}
                    setThinkingConfigs={setCompareThinkingConfigs}
                  />
                )}
              </div>

              {/* Bottom Controls */}
              <div className="p-4 border-t border-gray-200 dark:border-white/5 bg-gray-100/50 dark:bg-white/5 mt-auto space-y-6">
                
                {/* Mode Switcher */}
                <div className="flex bg-gray-200/50 dark:bg-black/20 p-1 rounded-xl">
                  <button
                    onClick={() => setViewMode('chat')}
                    className={`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-xs font-medium transition-all ${
                      viewMode === 'chat' 
                        ? 'bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 shadow-sm' 
                        : 'text-gray-500 hover:text-gray-800 dark:hover:text-gray-200'
                    }`}
                  >
                    <MessageSquare size={14} />
                    Chat
                  </button>
                  <button
                    onClick={() => setViewMode('compare')}
                    className={`flex-1 flex items-center justify-center gap-2 py-2 rounded-lg text-xs font-medium transition-all ${
                      viewMode === 'compare' 
                        ? 'bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 shadow-sm' 
                        : 'text-gray-500 hover:text-gray-800 dark:hover:text-gray-200'
                    }`}
                  >
                    <LayoutGrid size={14} />
                    Compare
                  </button>
                </div>

                {/* Model Selector (Only visible in Chat Mode) */}
                {viewMode === 'chat' && (
                  <ModelSelector 
                    selectedModel={selectedModel}
                    setSelectedModel={setSelectedModel}
                    selectedFamily={selectedFamily}
                    setSelectedFamily={setSelectedFamily}
                  />
                )}
                
                {/* Theme Toggle */}
                <div className="flex justify-end">
                   <button
                     onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')}
                     className="p-2.5 rounded-full bg-white dark:bg-white/10 border border-gray-200 dark:border-white/10 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:shadow-md transition-all"
                   >
                     {theme === 'dark' ? <Sun size={18} /> : <Moon size={18} />}
                   </button>
                </div>
              </div>
            </aside>

          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
